<?xml version="1.0" encoding="utf-8"?>
<TcPlcObject Version="1.1.0.1" ProductVersion="3.1.4024.15">
  <POU Name="MAIN" Id="{f44d6768-8f23-446b-b63e-3b950956c7f0}" SpecialFunc="None">
    <Declaration><![CDATA[PROGRAM MAIN
VAR
i_bCalldown AT %I* : ARRAY[0..9] OF BOOL;
i_bCallup AT %I* : ARRAY[1..10] OF BOOL;
i_bCurrentlevel AT %I* : ARRAY[0..10] OF BOOL;
i_bButtons AT %I* : ARRAY [0..10] OF BOOL;
i_bDooropen AT %I* : BOOL;
i_bDoorclosed AT %I* : BOOL;

o_bCalldownlamp AT %Q* : ARRAY[0..9] OF BOOL;
o_bCalluplamp AT %Q* : ARRAY[1..10] OF BOOL;
o_bButtonslamp AT %Q* : ARRAY[0..10] OF BOOL;
o_bMotordown AT %Q* : BOOL;
o_bMotorup AT %Q* : BOOL;
o_bDoorMotorOpen AT %Q* : BOOL;
o_bDoorMotorClose AT %Q* : BOOL;

i : INT;
calls : ARRAY [0..10] OF BOOL;
level : INT;
timer : TON;
END_VAR

VAR
	Timer : TON;
	PT : TIME := T#10S;

END_VAR
]]></Declaration>
    <Implementation>
      <ST><![CDATA[(*Fülke gombok hívásai*)
FOR i:=0 TO 10 DO
	IF i_bButtons[i] AND NOT i_bCurrentlevel[i] THEN
		calls[i] := i_bButtons[i];
		o_bButtonslamp[i] := i_bButtons[i];

	ELSIF i_bCurrentlevel[i] AND o_bDoormotoropen THEN
		calls[i] := FALSE;
		o_bButtonslamp[i] := FALSE;

		END_IF
END_FOR

(*Le hívások*)
FOR i:=0 TO 9 DO
	IF i_bCalldown[i] AND NOT i_bCurrentlevel[i] THEN
		calls[i] := i_bCalldown[i];
		o_bCalldownlamp[i] := i_bCalldown[i];

	ELSIF i_bCurrentlevel[i] AND o_bDoormotoropen THEN
		o_bCalldownlamp[i] := FALSE;
		calls[i] := FALSE;
	END_IF
END_FOR

(*Felhívások*)
FOR i:=1 TO 10 DO
	IF i_bCallup[i] AND NOT i_bCurrentlevel[i] THEN
		calls[i] := i_bCallup[i];
		o_bCalluplamp[i] := i_bCallup[i];

	ELSIF i_bCurrentlevel[i] AND o_bDoorMotorOpen THEN
		o_bCalluplamp[i] := FALSE;
		calls[i] := FALSE;
	END_IF
END_FOR

IF i_bCurrentlevel[level] AND o_bDoormotoropen THEN

	IF i_bDooropen AND i_bButtons[i] THEN
		o_bDoormotorclose := TRUE;
		Timer(IN := FALSE);

	ELSIF i_bDooropen AND NOT i_bButtons[i] THEN
		  Timer(IN := TRUE);

	 	IF Timer.Q THEN
		 o_bDoormotorclose := TRUE;
		 END_IF

	END_IF

END_IF]]></ST>
    </Implementation>
    <LineIds Name="MAIN">
      <LineId Id="2" Count="0" />
      <LineId Id="28" Count="0" />
      <LineId Id="33" Count="1" />
      <LineId Id="90" Count="0" />
      <LineId Id="96" Count="0" />
      <LineId Id="91" Count="0" />
      <LineId Id="117" Count="0" />
      <LineId Id="95" Count="0" />
      <LineId Id="92" Count="1" />
      <LineId Id="31" Count="0" />
      <LineId Id="74" Count="0" />
      <LineId Id="37" Count="3" />
      <LineId Id="97" Count="0" />
      <LineId Id="100" Count="1" />
      <LineId Id="104" Count="0" />
      <LineId Id="110" Count="0" />
      <LineId Id="103" Count="0" />
      <LineId Id="36" Count="0" />
      <LineId Id="27" Count="0" />
      <LineId Id="26" Count="0" />
      <LineId Id="43" Count="2" />
      <LineId Id="105" Count="2" />
      <LineId Id="109" Count="0" />
      <LineId Id="113" Count="0" />
      <LineId Id="46" Count="0" />
      <LineId Id="48" Count="0" />
      <LineId Id="75" Count="0" />
      <LineId Id="81" Count="0" />
      <LineId Id="139" Count="0" />
      <LineId Id="118" Count="1" />
      <LineId Id="121" Count="0" />
      <LineId Id="123" Count="0" />
      <LineId Id="122" Count="0" />
      <LineId Id="126" Count="0" />
      <LineId Id="137" Count="0" />
      <LineId Id="124" Count="0" />
      <LineId Id="135" Count="1" />
      <LineId Id="120" Count="0" />
      <LineId Id="85" Count="0" />
      <LineId Id="89" Count="0" />
      <LineId Id="84" Count="0" />
    </LineIds>
  </POU>
</TcPlcObject>
